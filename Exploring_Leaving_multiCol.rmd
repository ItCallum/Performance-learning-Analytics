---
title: "Exploring_Leaving_multiCol"
author: "Callum Simpson"
date: "24/11/2020"
output: html_document
---

```{r setup, include=FALSE}

setwd("Project/CSC8631_202021")

library('ProjectTemplate')
load.project()


```

## Anylsis of multipale colunms 

This document contains deeper dive into my now cleaned data (combine_Leaving_clean) to see what results I get when I look at multiple variables at the same time.
This is so that I could get a better understanding of patterns and correlations in the data


## The reason why a person left the course and there last completed step

In our last set of analysis we found that there was alot of people who left the course with out completing any step (under the assumtion that all NA values are actually not completed a week).

Doing a chi test we see that we get a p-value = 3.459e-07. As this is less than 0.05, we can reject the null hypothesis and conclude that the two variables leaving_reason and last_completed_week_number are independent from one another.

```{r reasonleft_lastComp}

combine_Leaving_clean_v2

percenatge_table <- as.data.frame(table(combine_Leaving_clean_v2$leaving_reason, combine_Leaving_clean_v2$last_completed_week_number)) %>% group_by(Var2) %>% mutate(percent = (Freq/sum(Freq)) * 100 ) 

chisq.test(table(combine_Leaving_clean_v2$leaving_reason, combine_Leaving_clean_v2$last_completed_week_number))

ggplot(combine_Leaving_clean_v2, aes(leaving_reason), fill=leaving_reason) + geom_bar() + 
  coord_flip() + ggtitle("The reason why people left") + facet_wrap(~ last_completed_week_number)


ggplot(percenatge_table, aes(x="", y = percent, fill=Var1)) + 
geom_bar(width = 1, stat = "identity") + ggtitle("The reason why people left") + facet_wrap(~ Var2)

```



## Step 3.2 

As we saw in a previous analysis there was a alot of people that left in at step 3.2 in cycle 5, we also see that there seems to be alot of people drop out at step 20 in the other years when compared to all other users who completed a step.

There are steps 1.1 to 1.19, 2.1 to 2.23 and 3.1 to 3.20

There are some steps where on one left but there is alot of people who left at step 3.2,  looking at the courses step 3.2 is a video (Devices in the future home VIDEO (03:26)).

However what should also be mentioned is that the final step is 3.20 , so there is a possiabilty that there has been some error in recording the data (people who finished the course are acidently put down as leaving)


```{r reasonleft_lastComp}

Step_32 <- combine_Leaving_clean_v2 %>% filter(last_completed_step == 3.2)

ggplot(Step_32, aes(leaving_reason), fill=leaving_reason) + geom_bar() + 
  coord_flip() + ggtitle("The reason why people left at step 32")

ggplot(Step_32, aes(leaving_reason), fill=leaving_reason) + geom_bar() + 
  coord_flip() + ggtitle("The reason why people left at step 32") + facet_wrap(~ Cycle)

ggplot(Step_32, aes(x=Date, y=Time, color=leaving_reason),  yaxt = "n") + geom_point()+ facet_wrap(~ Cycle, ncol = 1) + theme(legend.position="bottom")+
  theme(axis.text.y=element_blank(),axis.ticks.y=element_blank()) + ggtitle("Time line of users leaving and there Last completed week") +  geom_vline(xintercept = as.Date("2017-11-13")) +  geom_vline(xintercept = as.Date("2018-02-05")) +  geom_vline(xintercept = as.Date("2018-06-11")) + geom_vline(xintercept = as.Date("2018-09-10"))

```