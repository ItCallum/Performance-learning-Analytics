---
title: "Report"
author: "Callum Simpson"
date: "01/12/2020"
output: pdf_document
---

```{r setup, include=FALSE}
# Knitr setup
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir= normalizePath('..'))
```


```{r include=FALSE}
# Load project

library('ProjectTemplate')
load.project()

source("src/SC_for_merged_analysis.R")
source("src/SC_for_leaver_analysis.R")
source("src/SC_for_clean_enroled.R")
source("src/SC_for_clean_leaving_data.R")

```


# CSC8631 202021 Report
## By Callum Matthew Simspon
## b6030326

The following is my report of my analysis CSC8631 - Data Management and Exploratory Data Analysis course work. It will discuss my analysis and how I did it using the Crisp-DM model.


## Business understanding

As the first step in the Crisp-DM model is business understanding I first looked into the task that I had been given and who gave it was for.

### The Client background 

The cilent for this report will be Newcastle University who is using the site FutureLearn to host a course on Cyber Security: Safety at Home, Online, in Life. FutureLearn is an online training provider offering a wide selection of courses, often delivered in association with big-name colleges. Newcastle University is a UK public research university based in Newcastle upon Tyne

### The objective 

Newcastle university has gathered information about the users that have attended this course and are wanting to perform learning Analytics on this data to get insight into student engagement.

Learning Analytics is a rapidly-growing application area for Data Science, defined as “the measurement, collection, analysis and reporting of data about learners and their contexts, for purposes of understanding and optimizing learning and the environment in which it occurs”

As there is no formal requirement on the question that the university wants to be investigated I decided that I wanted to get a better understanding of why a user leaves the course. I feel like this would be a good measure of engagement as I could potentially find common reason and trends that are causing to leave the course meaning my findings could help improve the course to keep users engaged and lower the amount of people that leave the course. 

Because of this my business object will be "give useful insights into why people decide to leave the course"

### Assess situation 

I have been given data about the users who have attended the course, like enrollment data and answers to activity question. The data is split across seven run of the course (so each run has it own set of user data).  

### Determine data mining goals

As i am want to look into useful insights into why people decide to leave the course a clear data mining goal will be finding out the common reason a person leaves so that the course be updated to help reduce people leaving in the next cycle. Similarly another goal of mine should be be finding out who is leaving as again it means that measure could be put in check to increase engagement in that group. My success criteria will be data that clearly allows us to see why people are leaving. 

### Project plan

My aim is to 

- understand data by the 17th of November
- have the first clean bit of data by the 22nd of November 
- Have roughly two weeks to do my analysis 
- get my analysis done by the 1st of December.  

I am planning to use and R project with a project template to ensure that my code can be reproducible.

## Data understanding

### The Collect initial data 

The data I have been given is a set of different datasets relating to a different factor of the course. We have 7 of these "set" as we information about 7 runs of this course. New modifed data based off / using this data will be created automatically by my project template. I will say when its relevant when this has been done. 

### Description of all data  

The following will go over all the data collected and briefly outlies what is stored in each dataset.

#### Archetype survey responses

Only data for cycle 3 to 7 seems to be recorded. It a collection of the archetypes of the users with 4 columns.

id <int> - user id for cycle
learner_id <chr> - user id 
responded_at <chr> - the time a user responded
archetype <chr> - what Archetype they define themselves as

#### Cyber security enrolments

For all cycles,The enrollment data for each user. Contains 13 rows. Note worth rows are

id <int> - user id for cycle
learner_id <chr> - user id 
role <chr> - role of the person one the course 
gender <chr> - User identifed gender
country <chr> - give users country
age <chr> - ages done in age range brackets
highest education <chr> - Highest education.
It also contianes if they are employed and where 

#### cyber leaving results

Only for cycles 4 to 7. The reason people left and when about in the course they left.

id <int> - user id for cycle
learner_id <chr> - user id 

left_at <chr> - time and date when a user left the course
leaving_reason <chr> - the reason why the user left given from a set selection of given options
last_completed_step_at <chr> - time and date of the users last step
last_completed_step <dbl> - what was the users last step
last_completed_week_number <int> - what was the last week a user got to 
last_completed_step_number <int> - what was the users last step the completed


#### question response

For all cycles. The responses for the questions given throughout the course.

learner_id <chr> - user id 
quiz_question <chr> - the full question numner
question_type <chr> - the type of question
week_number <int> - the week number the question appread
step_number <int> - the step the question apperead
question_number <int> - the question sub number
response <chr> - users answers
cloze_response <lgl> - answer approximated
submitted_at <chr> - The time a user submitted the question
correct <chr> - Was the user correct.

#### Step activity

For all cycles. When a user started and finished that step

learner_id <chr> - user id 
step <dbl> - week + step number
week_number <int> - the week number
step_number <int> - the step number
first_visited_at <chr> - When the user first visited the step
last_completed_at <chr> - when the user finished the step

#### Team members

only in cycles 2 to 7. Contians information about peoples rows.


id <chr> - users id
first_name <chr> - users first name
last_name <chr> - users last name
team_role <chr> - team role is the role whole of the person in the team
user_role <chr> - user role seems to be role of what the user 

#### weekly_sentiment_survey_responses

Seems to be only cycles 6 and 7. A brief survay about how people are finding the course

id <int> - user ID
responded_at <chr> - the time the user responded.
week_number <int> - the week 
experience_rating <int> - out of 5 how did the user rate the week
reason <chr> - a comment on their opinion

####video_stats

For all cycles. Information about the videos. There are 23 columns so instead of listing everything out this data set contianes

how long people are watching a video
where they are watching it 
what people are watching it on


### Overview

As you can see we have alot of data at hand to help us answer the question. Each dataset has an ID function so that can be our meta data that can be used to link all the dataset together. Exploring the dataset its clear that not all cycles contain the same recorded data as others. This has lead me to make my first assumption.

## Assumption One

Not all data was recorded in each cycle as some cycles contain empty datafile. I am assuming that this is because as the cycles went on new aspects user interaction where recorded.

## Choosing the right data

After doing a scan over all the data I decided on what I was going to use. As i decided to look into why user left the course and obvious start would be by looking at the the courses leaving results to see what users where saying.

As I had 4 datasets to work with (cycles 4 to 7) I merged them together but made sure that i included an new column called Cycle <dbl> which contains the cycle number that that row of data came from. This made a dataframe of `nrow(combine_Leaving)` rows.


The next two sections on exploring data and verify data quality will be on this dataset.

## ExploreData

### ID variables 

As I merged 4 datasets together i wanted to make sure that there wast any weird duplicates or any in cycle duplication for our 2 variables are relating id.

```{r ID_Var_dups}

print("Any Duplcate ID")
table_dup_ID

print("Any Duplcate Learner ID")
table_dup_Learner_ID

```

We see that id has no duplicates but learner_id did contain some duplicate ids.

From a check for duplicates we find that for the most part are the same learner id but in a different cycle suggesting that we have a few people who are leaving deciding to leave one cycle but rejoining another cycle only to leave again later. This is fine as its same user different cycles and not same user same cycle.

If we look at duplaices of learner_id and cycle we find 15 occurrences. For the most part we find alot of these duplicates are within a few minuets of each other, However some of these dates are days out. 

```{r ID_Var_dups}
dup_learner_id_and_cycle %>% select(id,learner_id,left_at,Cycle)
```

To be safe I decided to remove all these duplicate values leaving us with `nrows(removed_duplicate_df)` rows to work with.


### How many people left each cycle 

Next I wanted to see how many people left each cycle so i decided to make a barplot to check the counts.

```{r how_many_people_left}

bar_chart_of_user_per_cycle

```
As there is no NA coloum we can safely ensure that every row has be assigned to a cycle.

As we can see there was almost double the amount of people leaving in cycle 5 as compared to other cycles suggesting that either 
  + a) alot of people joined in cycle 5 than compared to the other years
  + b) Somthing caused alot of people to leave this year than compared to the other years
  
### Reason for leaving

As we can see the reason why people leave the course we can try to find the main reason for people leaving. 

```{r The_reason_given_to_why_people_left}

Reason_Count

```
Looking at all the results put together we see that the majority of the user left as they don't have enough time or for another unknown reason (other). We see that there is a few more people saying that they left because the course was too difficult than there is saying the course is too easy, this suggest that one the whole people seem to find the course hardier than easier. 

We also see that there inst any NA values suggesting that the data is complete and every row containes a reason for leaving.


#### last_completed_step 

The last completed step tells us how far a user made it through the course. I expect that the majortity of the peole leave at the start.

```{r last_completed_step}

print("--last_completed_week_number--")
table(combine_Leaving_NoDups$last_completed_step, useNA="always")

```
We see that there are 32 individual steps though out the database. Looking at the table of results we see that there the is alot of (over 50%) NA values in this data set suggesting that the quality may not be that create.Whilist we see a few people leaving at the start we see an stark increase at step 3.2 which suggest that there is somthing at that week that is causing people to leave.

#### last_completed_week_number

I decide to keep the last week number in as it would be useful to group all of the week steps together so we can record how far a user got through the course by large milestones and not small steps. last_completed_week_number has a lot of different factors so visualizing the results may be difficult.

```{r how_many_people_left}

print("--last_completed_week_number--")
table(combine_Leaving_NoDups$last_completed_week_number, useNA="always")

```
Looking at the table of results we see that there the is alot of (over 50%) NA values in this data set. What is interesting is that there the same amount of NA values that where found in the last_completed_step suggesting that there might be some similarities in these NA values which might be worth looking into to.

Not looking at the NA we see that the first week has alot of people leaving and not that many leaving in the secound week.

#### last_completed_step_number

For the the rest of my analysis i will likely ignore this column as it step number if each week. As we have 3 weeks of content then we will have duplicate step number values for each step so its will be likely that is will cause confusion down the line. The last_completed_step contains the week and step number so it wouldn't have this issue. Because of that I will not need this column.

#### Left at

The last column to check was the leave date. A quick check of this colum showed no error.
